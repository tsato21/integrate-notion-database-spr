---
layout: default
---
<div class="content">
    <div class="container py-4">
        <h1 id="top" class="mb-4">Automatic Integration of Notion Database with Spreadsheet and Generation of Pie Chart</h1>
        <p>This project integrates Notion databases and Google Sheets, focusing on financial management. It uses Google Apps Script to fetch data from Notion, then visualizes it in Google Sheets, enhancing data analysis efficiency and accessibility.</p>
        <ul>
            <li>Automates data transfer from Notion to Google Sheets.</li>
            <li>Generates dynamic pie charts based on categorized data.</li>
            <li>Enhances data visualization and decision-making processes.</li>
        </ul>

        <h2 id="prerequisites" class="mt-4">Prerequisites</h2>
        <ul>
            <li>A Google account with access to Google Sheets.</li>
            <li>A foundational understanding of Google Sheets, Google Apps Script, Notion, Notion API.</li>
        </ul>

        <h2 id="setup" class="mt-4">Setup</h2>
        <ol>
            <li>
                <strong>Access Your Google Sheet</strong>: Begin by opening the <a href="https://docs.google.com/spreadsheets/d/1lQV51pXWX9gwPgQMlnY6CgJD6_k01_4U3ErcoDTqD5o/edit#gid=1013719003" target="_blank" rel="noopener noreferrer">Sample Google Sheet</a>.
            </li>
            <li>
                <strong>Copy the Sheet</strong>: Make a copy of the Google Sheet to create your personalized version.
            </li>
            <li>
                <strong>Authorization</strong>: Navigate to the 'Custom Menu' and click the 'Conduct Authorization' button to start the Google Apps Script authorization process.
            </li>
        </ol>


        <section id="usage" class="mt-4">
          <h2>Usage</h2>
          <p>Optimize your workflow by leveraging the capabilities of this project:</p>
          <ol class="list-group list-group-numbered">
            <li class="list-group-item">
              <strong>Notion API</strong>: Create a Notion API for integration.
            </li>
            <li class="list-group-item">
              <strong>Notion Database</strong>: 
              <ol>
                <li>Create a database for integration. When creating a database, ensure the following columns with designated data types are set:
                  <ul>
                    <li>Item: Title</li>
                    <li>Category: Select or Relation</li>
                    <li>Pay Amount: Number</li>
                  </ul>
                </li>
                <li>Input each item record in the database.</li>
              </ol>
            </li>
            <li class="list-group-item">
              <strong>Spreadsheet</strong>: 
              <ol>
                <li>Create a new sheet to display record details from the Notion database.</li>
                <li>Navigate to Apps Script>`variables.gs' and set each variable.
                  <ul>
                    <li>For all databases (In creation of second or subsequent databases, skip this step):
                      <ul>
                        <li>const notionToken: Notion API Secret Key</li>
                        <li>const sheetNameChart: Name of the sheet where pie charts are displayed. By default, it is named as "Chart"</li>
                      </ul>
                    </li>
                    <li>For each database:
                      <ul>
                        <li>const tableId: ID of the target Notion database</li>
                        <li>const sheetName: the name of the sheet where the record details from the target notion database are displayed</li>
                        <li>const item/ const category/ const monthlyPay: Names of each field in Notion database</li>
                        <li>const chartName: Name of the chart which is displayed at the top of the chart.</li>
                      </ul>
                    </li>
                  </ul>
                  <p>When creating second or subsequent pie charts, copy the variables and change the values of each variable. You can find a sample of this setting <a href="https://docs.google.com/presentation/d/1-vphEn7APWwV29E1v7d4BBDAvl92EGSXmY5BLAXWpxU/edit#slide=id.g26522cd8648_0_12">HERE</a>.</p>
                </li>
                <li>Create a trigger function in `codes.gs`. Ensure the required parameters are included and the variable names in the parameters are consistent with those set in `variables.gs`. The row and column parameters can be set as desired.</li>
                <li>Test the trigger function: Verify that the records of the target Notion database are fetched and the pie chart for the database is successfully generated.</li>
                <li>Set the trigger for the function: Navigate to 'Trigger' in Apps Script to set the trigger to fire the function. It is recommended to set the trigger as onOpen so that every time the spreadsheet is open, the pie chart is updated.</li>
              </ol>
            </li>
          </ol>
        </section>
        

        <h2 id="others" class="mt-4">Others</h2>
        <ul>
            <li>Customize the scripts to align with your specific workflow and requirements.</li>
        </ul>
    </div>
</div>
